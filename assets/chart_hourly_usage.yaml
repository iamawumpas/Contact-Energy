type: custom:apexcharts-card
header:
  show: true
  title: Hourly Usage (Last 10 Days)
  show_states: false
apex_config:
  chart:
    height: 300
  legend:
    position: top
  xaxis:
    type: datetime
    labels:
      format: ddd
graph_span: 10d
series:
  - entity: sensor.71_oroua_st_0000000966tr348_usage_2
    name: Free
    color: '#008FFB'
    type: column
    data_generator: |
      // Get all data from sensor attribute
      const allData = entity.attributes.hourly_free_data || {};
      
      // Generate all hourly slots for last 10 days
      const now = new Date();
      const tenDaysAgo = new Date(now);
      tenDaysAgo.setDate(tenDaysAgo.getDate() - 10);
      
      const result = [];
      const current = new Date(tenDaysAgo);
      current.setHours(0, 0, 0, 0);
      
      // Create entry for each hour in the last 10 days
      while (current <= now) {
        const isoString = current.toISOString();
        // Find matching data (handles timezone offset variations)
        let value = 0.0;
        for (const [key, val] of Object.entries(allData)) {
          if (key.substring(0, 13) === isoString.substring(0, 13)) {
            value = val;
            break;
          }
        }
        result.push([current.getTime(), value]);
        current.setHours(current.getHours() + 1);
      }
      return result;
  - entity: sensor.71_oroua_st_0000000966tr348_usage_2
    name: Paid
    color: '#FEB019'
    type: column
    data_generator: |
      // Get all data from sensor attribute
      const allData = entity.attributes.hourly_data || {};
      
      // Generate all hourly slots for last 10 days
      const now = new Date();
      const tenDaysAgo = new Date(now);
      tenDaysAgo.setDate(tenDaysAgo.getDate() - 10);
      
      const result = [];
      const current = new Date(tenDaysAgo);
      current.setHours(0, 0, 0, 0);
      
      // Create entry for each hour in the last 10 days
      while (current <= now) {
        const isoString = current.toISOString();
        // Find matching data (handles timezone offset variations)
        let value = 0.0;
        for (const [key, val] of Object.entries(allData)) {
          if (key.substring(0, 13) === isoString.substring(0, 13)) {
            value = val;
            break;
          }
        }
        result.push([current.getTime(), value]);
        current.setHours(current.getHours() + 1);
      }
      return result;
card_mod:
  style:
    apexcharts$: |
      .apexcharts-canvas {
        filter: drop-shadow(0px 4px 4px rgba(0, 0, 0, 0.15));
      }